(()=>{"use strict";const e=[[6,null,2],[3,4,8],[7,1,5]],t=[[1,2,3],[4,5,6],[7,8,null]],o=[{x:0,y:-1,name:"⇐"},{x:-1,y:0,name:"⇑"},{x:0,y:1,name:"⇒"},{x:1,y:0,name:"⇓"}],n=(e,t,o=!0)=>{console.log(`Index of the state ${t}`);let n="";for(let t of e){const e=t.map((e=>e||" "));n+="-------------\n",n+=`| ${e[0]} | ${e[1]} | ${e[2]} |\n`}return n+="-------------\n",o&&console.log(n),n},l=e=>{let t={x:0,y:0,name:"empty"};e:for(let o=0;o<e[0].length;++o)for(let n=0;n<e.length;++n)if(null===e[o][n]){t.x=o,t.y=n;break e}return t},s=e=>e.x>=3||e.x<0||e.y>=3||e.y<0;class r{constructor(e,t,o,l,s){this.getState=()=>this.state,this.getMoves=()=>this.operator,this.getDepth=()=>this.depth,this.pathFromStart=()=>{let e=[],t=[],o=this;do{e.push(o?.getState()),t.push(o?.getMoves()),o=o?.parent,o.parent||e.push(o?.getState())}while(0!==o?.getDepth());e.reverse(),t.reverse();let l=1;for(const t of e)n(t,l),l++;return console.log(`Кількість переміщень: ${t.length}`),console.log(`Переміщення по порядку: ${t.join(", ")}\n`),t},this.state=e,this.parent=t,this.operator=o,this.depth=l,this.cost=s}}const a=new Map;a.set(e.toString(),!0);const i=[new r(e,null,null,0,0)],c=[{state:e,index:1}];let d={currentState:null,moves:0,settled:0,dropped:0,depth:0,haveSolution:!1};{!function(){let e=0,n=0;for(;i.length;){let g=i.shift();if(d={currentState:g,moves:e,settled:a.size,dropped:n,depth:g.getDepth(),haveSolution:!1},h=g.getState(),p=t,h?.toString()===p?.toString())return void(d.haveSolution=!0);const u=l(g.getState());o.forEach((t=>{const o=g?.getState()?.map((e=>[...e])),l={x:u.x+t.x,y:u.y+t.y,name:t.name};s(l)||([o[u.x][u.y],o[l.x][l.y]]=[o[l.x][l.y],o[u.x][u.y]],a.get(o.toString())?n++:(i.push(new r(o,g,t.name,g.getDepth()+1,0)),a.set(o.toString(),!0),c.push({state:o,index:e+2})),e++)}))}var h,p}();const e=document.querySelector(".next"),h=document.querySelector(".result"),p=document.getElementById("results");let g=0;e?.addEventListener("click",(()=>{p?.insertAdjacentHTML("beforeend",`\n        <h2 class="text-primary fw-bold">Index of the state is ${c[g].index}</h2>\n      `);const e=document.createElement("table");e.className+="table table-primary table-hover table-bordered table-sm align-middle",e.style.width="200px",e.style.height="200px";const t=document.createElement("tbody");for(let e of c[g].state){const o=t.insertRow();for(let t of e){const e=o.insertCell();e.classList.add("align-middle"),e.innerHTML=t?String(t):" "}}e.appendChild(t),p?.appendChild(e),n(c[g].state,c[g].index),g++})),h?.addEventListener("click",(()=>{d.haveSolution?(console.log("Порядок переміщень для розв'язку гри в 8 :"),d?.currentState?.pathFromStart(),console.log(`Кількість відвіданих станів : ${d.moves}`),console.log(`Кількість станів занесених у БД : ${d.settled} `),console.log(`Кількість відкинутих станів : ${d.dropped}`),console.log(`Глибина дерева пошуку на якій знайдено рішення : ${d.depth}`)):(console.log(`Кількість відвіданих станів : ${d.moves}`),console.log(`Кількість станів занесених у БД : ${d.settled} `),console.log(`Кількість відкинутих станів : ${d.dropped}`),console.log("Гра у 8 немає розв'язків"))}))}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFRQyxJQUFJLGlDQUFpQ3FDLEVBQVFJLFdBQ3JEMUMsUUFBUUMsSUFBSSw0QkErRkUsR0FFdEIsQyIsInNvdXJjZXMiOlsid2VicGFjazovL2xhYjEvLi9zcmMvY29uc3RhbnRzLnRzIiwid2VicGFjazovL2xhYjEvLi9zcmMvaGVscGVycy50cyIsIndlYnBhY2s6Ly9sYWIxLy4vc3JjL25vZGUudHMiLCJ3ZWJwYWNrOi8vbGFiMS8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBleHBvcnQgY29uc3QgaW5pdGlhbFN0YXRlID0gW1xyXG4vLyAgIFs1LCA2LCA3XSxcclxuLy8gICBbOCwgMSwgMl0sXHJcbi8vICAgWzMsIDQsIG51bGxdLFxyXG4vLyBdO1xyXG4vLyBleHBvcnQgY29uc3QgaW5pdGlhbFN0YXRlID0gW1xyXG4vLyAgIFszLCAxLCAyXSxcclxuLy8gICBbNCwgNSwgbnVsbF0sXHJcbi8vICAgWzcsIDgsIDZdLFxyXG4vLyBdO1xyXG5leHBvcnQgY29uc3QgaW5pdGlhbFN0YXRlID0gW1xyXG4gICAgWzYsIG51bGwsIDJdLFxyXG4gICAgWzMsIDQsIDhdLFxyXG4gICAgWzcsIDEsIDVdLFxyXG5dO1xyXG5leHBvcnQgY29uc3QgZmluYWxTdGF0ZSA9IFtcclxuICAgIFsxLCAyLCAzXSxcclxuICAgIFs0LCA1LCA2XSxcclxuICAgIFs3LCA4LCBudWxsXSxcclxuXTtcclxuZXhwb3J0IGNvbnN0IGRpcmVjdGlvbnMgPSBbXHJcbiAgICB7IHg6IDAsIHk6IC0xLCBuYW1lOiBcIuKHkFwiIH0sXHJcbiAgICB7IHg6IC0xLCB5OiAwLCBuYW1lOiBcIuKHkVwiIH0sXHJcbiAgICB7IHg6IDAsIHk6IDEsIG5hbWU6IFwi4oeSXCIgfSxcclxuICAgIHsgeDogMSwgeTogMCwgbmFtZTogXCLih5NcIiB9LFxyXG5dO1xyXG5leHBvcnQgY29uc3Qgc2l6ZSA9IDM7XHJcbmV4cG9ydCBjb25zdCBwcm9kdWN0aW9uID0gdHJ1ZTtcclxuIiwiaW1wb3J0IHsgc2l6ZSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xyXG5leHBvcnQgZnVuY3Rpb24qIGdldEV4ZWN1dGlvblRpbWUoKSB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgeWllbGQgMTtcclxuICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgZGlmZiA9IG5ldyBEYXRlKGVuZFRpbWUgLSBzdGFydFRpbWUpO1xyXG4gICAgY29uc3QgZXhlY3V0aW9uID0gZGlmZi5nZXRTZWNvbmRzKCkgKyAwLjAwMSAqIGRpZmYuZ2V0TWlsbGlzZWNvbmRzKCk7XHJcbiAgICBjb25zb2xlLmxvZyhgRXhlY3V0aW9uIHRpbWU6ICR7ZXhlY3V0aW9ufSBzZWNvbmRzYCk7XHJcbn1cclxuZXhwb3J0IGNvbnN0IGRpc3BsYXlCb2FyZCA9IChzdGF0ZSwgaW5kZXgsIGRlYnVnID0gdHJ1ZSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coYEluZGV4IG9mIHRoZSBzdGF0ZSAke2luZGV4fWApO1xyXG4gICAgbGV0IGRpc3BsYXkgPSBcIlwiO1xyXG4gICAgZm9yIChsZXQgcm93IG9mIHN0YXRlKSB7XHJcbiAgICAgICAgY29uc3QgY2VsbHMgPSByb3cubWFwKChpdGVtKSA9PiAoIWl0ZW0gPyBcIiBcIiA6IGl0ZW0pKTtcclxuICAgICAgICBkaXNwbGF5ICs9IFwiLS0tLS0tLS0tLS0tLVxcblwiO1xyXG4gICAgICAgIGRpc3BsYXkgKz0gYHwgJHtjZWxsc1swXX0gfCAke2NlbGxzWzFdfSB8ICR7Y2VsbHNbMl19IHxcXG5gO1xyXG4gICAgfVxyXG4gICAgZGlzcGxheSArPSBcIi0tLS0tLS0tLS0tLS1cXG5cIjtcclxuICAgIGlmIChkZWJ1ZylcclxuICAgICAgICBjb25zb2xlLmxvZyhkaXNwbGF5KTtcclxuICAgIHJldHVybiBkaXNwbGF5O1xyXG59O1xyXG5leHBvcnQgY29uc3QgZ2V0RW1weUNlbGxDb29yZHMgPSAoc3RhdGUpID0+IHtcclxuICAgIGxldCBjb29yZGluYXRlcyA9IHsgeDogMCwgeTogMCwgbmFtZTogXCJlbXB0eVwiIH07XHJcbiAgICBvdXRlcjogZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZVswXS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc3RhdGUubGVuZ3RoOyArK2opIHtcclxuICAgICAgICAgICAgaWYgKHN0YXRlW2ldW2pdID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb29yZGluYXRlcy54ID0gaTtcclxuICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzLnkgPSBqO1xyXG4gICAgICAgICAgICAgICAgYnJlYWsgb3V0ZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29vcmRpbmF0ZXM7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBzdGF0ZXNBcmVFcXVhbCA9IChzdGF0ZSwgc2Vjb25kU3RhdGUpID0+IHtcclxuICAgIHJldHVybiBzdGF0ZT8udG9TdHJpbmcoKSA9PT0gc2Vjb25kU3RhdGU/LnRvU3RyaW5nKCk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBpc091dE9mQm9yZGVyID0gKGNvb3JkcykgPT4ge1xyXG4gICAgaWYgKGNvb3Jkcy54ID49IHNpemUgfHwgY29vcmRzLnggPCAwKVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgaWYgKGNvb3Jkcy55ID49IHNpemUgfHwgY29vcmRzLnkgPCAwKVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG4iLCJpbXBvcnQgeyBkaXNwbGF5Qm9hcmQgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XHJcbmV4cG9ydCBjbGFzcyBOb2RlIHtcclxuICAgIGNvbnN0cnVjdG9yKHN0YXRlLCBwYXJlbnQsIG9wZXJhdG9yLCBkZXB0aCwgY29zdCkge1xyXG4gICAgICAgIHRoaXMuZ2V0U3RhdGUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXRlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRNb3ZlcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3BlcmF0b3I7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldERlcHRoID0gKCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZXB0aDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucGF0aEZyb21TdGFydCA9ICgpID0+IHtcclxuICAgICAgICAgICAgbGV0IHN0YXRlTGlzdCA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgbW92ZUxpc3QgPSBbXTtcclxuICAgICAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gdGhpcztcclxuICAgICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICAgICAgc3RhdGVMaXN0LnB1c2goY3VycmVudE5vZGU/LmdldFN0YXRlKCkpO1xyXG4gICAgICAgICAgICAgICAgbW92ZUxpc3QucHVzaChjdXJyZW50Tm9kZT8uZ2V0TW92ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlPy5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnROb2RlLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlTGlzdC5wdXNoKGN1cnJlbnROb2RlPy5nZXRTdGF0ZSgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSB3aGlsZSAoY3VycmVudE5vZGU/LmdldERlcHRoKCkgIT09IDApO1xyXG4gICAgICAgICAgICBzdGF0ZUxpc3QucmV2ZXJzZSgpO1xyXG4gICAgICAgICAgICBtb3ZlTGlzdC5yZXZlcnNlKCk7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9IDE7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBzdGF0ZUxpc3QpIHtcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlCb2FyZChpdGVtLCBpbmRleCk7XHJcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQmtGW0LvRjNC60ZbRgdGC0Ywg0L/QtdGA0LXQvNGW0YnQtdC90Yw6ICR7bW92ZUxpc3QubGVuZ3RofWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0J/QtdGA0LXQvNGW0YnQtdC90L3RjyDQv9C+INC/0L7RgNGP0LTQutGDOiAke21vdmVMaXN0LmpvaW4oXCIsIFwiKX1cXG5gKTtcclxuICAgICAgICAgICAgcmV0dXJuIG1vdmVMaXN0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgIHRoaXMub3BlcmF0b3IgPSBvcGVyYXRvcjtcclxuICAgICAgICB0aGlzLmRlcHRoID0gZGVwdGg7XHJcbiAgICAgICAgdGhpcy5jb3N0ID0gY29zdDtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBkaXJlY3Rpb25zLCBmaW5hbFN0YXRlLCBpbml0aWFsU3RhdGUsIHByb2R1Y3Rpb24gfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcclxuaW1wb3J0IHsgZGlzcGxheUJvYXJkLCBnZXRFbXB5Q2VsbENvb3JkcywgZ2V0RXhlY3V0aW9uVGltZSwgaXNPdXRPZkJvcmRlciwgc3RhdGVzQXJlRXF1YWwsIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xyXG5pbXBvcnQgeyBOb2RlIH0gZnJvbSBcIi4vbm9kZVwiO1xyXG5jb25zdCBkYiA9IG5ldyBNYXAoKTtcclxuZGIuc2V0KGluaXRpYWxTdGF0ZS50b1N0cmluZygpLCB0cnVlKTtcclxuY29uc3QgcXVldWUgPSBbbmV3IE5vZGUoaW5pdGlhbFN0YXRlLCBudWxsLCBudWxsLCAwLCAwKV07XHJcbmNvbnN0IGFsbFN0YXRlcyA9IFtcclxuICAgIHsgc3RhdGU6IGluaXRpYWxTdGF0ZSwgaW5kZXg6IDEgfSxcclxuXTtcclxubGV0IHJlc3VsdHMgPSB7XHJcbiAgICBjdXJyZW50U3RhdGU6IG51bGwsXHJcbiAgICBtb3ZlczogMCxcclxuICAgIHNldHRsZWQ6IDAsXHJcbiAgICBkcm9wcGVkOiAwLFxyXG4gICAgZGVwdGg6IDAsXHJcbiAgICBoYXZlU29sdXRpb246IGZhbHNlLFxyXG59O1xyXG5jb25zdCBwcmludFJlc3VsdHMgPSAoKSA9PiB7XHJcbiAgICBpZiAoIXJlc3VsdHMuaGF2ZVNvbHV0aW9uKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQstGW0LTQsNC90LjRhSDRgdGC0LDQvdGW0LIgOiAke3Jlc3VsdHMubW92ZXN9YCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDRgdGC0LDQvdGW0LIg0LfQsNC90LXRgdC10L3QuNGFINGDINCR0JQgOiAke3Jlc3VsdHMuc2V0dGxlZH0gYCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQutC40L3Rg9GC0LjRhSDRgdGC0LDQvdGW0LIgOiAke3Jlc3VsdHMuZHJvcHBlZH1gKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcItCT0YDQsCDRgyA4INC90LXQvNCw0ZQg0YDQvtC30LIn0Y/Qt9C60ZbQslwiKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi0J/QvtGA0Y/QtNC+0Log0L/QtdGA0LXQvNGW0YnQtdC90Ywg0LTQu9GPINGA0L7Qt9CyJ9GP0LfQutGDINCz0YDQuCDQsiA4IDpcIik7XHJcbiAgICAgICAgcmVzdWx0cz8uY3VycmVudFN0YXRlPy5wYXRoRnJvbVN0YXJ0KCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQstGW0LTQsNC90LjRhSDRgdGC0LDQvdGW0LIgOiAke3Jlc3VsdHMubW92ZXN9YCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDRgdGC0LDQvdGW0LIg0LfQsNC90LXRgdC10L3QuNGFINGDINCR0JQgOiAke3Jlc3VsdHMuc2V0dGxlZH0gYCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQutC40L3Rg9GC0LjRhSDRgdGC0LDQvdGW0LIgOiAke3Jlc3VsdHMuZHJvcHBlZH1gKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhg0JPQu9C40LHQuNC90LAg0LTQtdGA0LXQstCwINC/0L7RiNGD0LrRgyDQvdCwINGP0LrRltC5INC30L3QsNC50LTQtdC90L4g0YDRltGI0LXQvdC90Y8gOiAke3Jlc3VsdHMuZGVwdGh9YCk7XHJcbiAgICB9XHJcbn07XHJcbmNvbnN0IEJGUyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGxldCBtb3ZlcyA9IDAsIGRyb3BwZWRTdGF0ZXMgPSAwO1xyXG4gICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkge1xyXG4gICAgICAgIGxldCBjdXJyZW50U3RhdGUgPSBxdWV1ZS5zaGlmdCgpO1xyXG4gICAgICAgIHJlc3VsdHMgPSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRTdGF0ZTogY3VycmVudFN0YXRlLFxyXG4gICAgICAgICAgICBtb3ZlczogbW92ZXMsXHJcbiAgICAgICAgICAgIHNldHRsZWQ6IGRiLnNpemUsXHJcbiAgICAgICAgICAgIGRyb3BwZWQ6IGRyb3BwZWRTdGF0ZXMsXHJcbiAgICAgICAgICAgIGRlcHRoOiBjdXJyZW50U3RhdGUuZ2V0RGVwdGgoKSxcclxuICAgICAgICAgICAgaGF2ZVNvbHV0aW9uOiBmYWxzZSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChzdGF0ZXNBcmVFcXVhbChjdXJyZW50U3RhdGUuZ2V0U3RhdGUoKSwgZmluYWxTdGF0ZSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0cy5oYXZlU29sdXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGVtcHR5Q2VsbCA9IGdldEVtcHlDZWxsQ29vcmRzKGN1cnJlbnRTdGF0ZS5nZXRTdGF0ZSgpKTtcclxuICAgICAgICBkaXJlY3Rpb25zLmZvckVhY2goKGRpcmVjdGlvbikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb3B5U3RhdGUgPSBjdXJyZW50U3RhdGVcclxuICAgICAgICAgICAgICAgID8uZ2V0U3RhdGUoKVxyXG4gICAgICAgICAgICAgICAgPy5tYXAoKHJvdykgPT4gWy4uLnJvd10pO1xyXG4gICAgICAgICAgICAvLyBjb29yZHMgY2VsbCB0byBzd2l0Y2hcclxuICAgICAgICAgICAgY29uc3QgY29vcmRzID0ge1xyXG4gICAgICAgICAgICAgICAgeDogZW1wdHlDZWxsLnggKyBkaXJlY3Rpb24ueCxcclxuICAgICAgICAgICAgICAgIHk6IGVtcHR5Q2VsbC55ICsgZGlyZWN0aW9uLnksXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkaXJlY3Rpb24ubmFtZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgLy8gaWYgY29vcmRzIG9mIHN3YXBwZWQgY2VsbCBpcyBub3Qgb3V0IHRoZSBib3JkZXIgb2YgdGhlIGZpZWxkXHJcbiAgICAgICAgICAgIGlmICghaXNPdXRPZkJvcmRlcihjb29yZHMpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBtb3ZlIGVtcHR5IGNlbGwgaW50byBjdXJyZW50IGRpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgW2NvcHlTdGF0ZVtlbXB0eUNlbGwueF1bZW1wdHlDZWxsLnldLCBjb3B5U3RhdGVbY29vcmRzLnhdW2Nvb3Jkcy55XV0gPSBbXHJcbiAgICAgICAgICAgICAgICAgICAgY29weVN0YXRlW2Nvb3Jkcy54XVtjb29yZHMueV0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29weVN0YXRlW2VtcHR5Q2VsbC54XVtlbXB0eUNlbGwueV0sXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgc3dhcHBlZCBzdGF0ZSBpcyBub3QgcHJlc2VudCBpbiBkYXRhYmFzZVxyXG4gICAgICAgICAgICAgICAgaWYgKCFkYi5nZXQoY29weVN0YXRlLnRvU3RyaW5nKCkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVldWUucHVzaChuZXcgTm9kZShjb3B5U3RhdGUsIGN1cnJlbnRTdGF0ZSwgZGlyZWN0aW9uLm5hbWUsIGN1cnJlbnRTdGF0ZS5nZXREZXB0aCgpICsgMSwgMCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRiLnNldChjb3B5U3RhdGUudG9TdHJpbmcoKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxsU3RhdGVzLnB1c2goeyBzdGF0ZTogY29weVN0YXRlLCBpbmRleDogbW92ZXMgKyAyIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcHBlZFN0YXRlcysrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbW92ZXMrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLy8gZGlzcGxheUJvYXJkKGFsbFN0YXRlc1thbGxTdGF0ZXMubGVuZ3RoIC0gMV0pO1xyXG59O1xyXG5pZiAocHJvZHVjdGlvbikge1xyXG4gICAgQkZTKCk7XHJcbiAgICBjb25zdCBuZXh0U3RhdGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm5leHRcIik7XHJcbiAgICBjb25zdCByZXN1bHRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJlc3VsdFwiKTtcclxuICAgIGNvbnN0IHJlc3VsdHNXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzXCIpO1xyXG4gICAgbGV0IGluZGV4ID0gMDtcclxuICAgIG5leHRTdGF0ZUJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICByZXN1bHRzV3JhcHBlcj8uaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGBcbiAgICAgICAgPGgyIGNsYXNzPVwidGV4dC1wcmltYXJ5IGZ3LWJvbGRcIj5JbmRleCBvZiB0aGUgc3RhdGUgaXMgJHthbGxTdGF0ZXNbaW5kZXhdLmluZGV4fTwvaDI+XG4gICAgICBgKTtcclxuICAgICAgICBjb25zdCB0YWJsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0YWJsZVwiKTtcclxuICAgICAgICB0YWJsZS5jbGFzc05hbWUgKz1cclxuICAgICAgICAgICAgXCJ0YWJsZSB0YWJsZS1wcmltYXJ5IHRhYmxlLWhvdmVyIHRhYmxlLWJvcmRlcmVkIHRhYmxlLXNtIGFsaWduLW1pZGRsZVwiO1xyXG4gICAgICAgIHRhYmxlLnN0eWxlLndpZHRoID0gXCIyMDBweFwiO1xyXG4gICAgICAgIHRhYmxlLnN0eWxlLmhlaWdodCA9IFwiMjAwcHhcIjtcclxuICAgICAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiKTtcclxuICAgICAgICBmb3IgKGxldCByb3cgb2YgYWxsU3RhdGVzW2luZGV4XS5zdGF0ZSkge1xyXG4gICAgICAgICAgICBjb25zdCB0YWJsZVJvdyA9IHRib2R5Lmluc2VydFJvdygpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjb2wgb2Ygcm93KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZCA9IHRhYmxlUm93Lmluc2VydENlbGwoKTtcclxuICAgICAgICAgICAgICAgIHRkLmNsYXNzTGlzdC5hZGQoXCJhbGlnbi1taWRkbGVcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNvbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRkLmlubmVySFRNTCA9IFwiIFwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGQuaW5uZXJIVE1MID0gU3RyaW5nKGNvbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGJvZHkpO1xyXG4gICAgICAgIHJlc3VsdHNXcmFwcGVyPy5hcHBlbmRDaGlsZCh0YWJsZSk7XHJcbiAgICAgICAgZGlzcGxheUJvYXJkKGFsbFN0YXRlc1tpbmRleF0uc3RhdGUsIGFsbFN0YXRlc1tpbmRleF0uaW5kZXgpO1xyXG4gICAgICAgIGluZGV4Kys7XHJcbiAgICB9KTtcclxuICAgIHJlc3VsdEJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBwcmludFJlc3VsdHMoKTtcclxuICAgIH0pO1xyXG59XHJcbmVsc2Uge1xyXG4gICAgY29uc3QgdGltZXIgPSBnZXRFeGVjdXRpb25UaW1lKCk7XHJcbiAgICB0aW1lci5uZXh0KCk7XHJcbiAgICBCRlMoKTtcclxuICAgIHRpbWVyLm5leHQoKTtcclxuICAgIHByaW50UmVzdWx0cygpO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJpbml0aWFsU3RhdGUiLCJmaW5hbFN0YXRlIiwiZGlyZWN0aW9ucyIsIngiLCJ5IiwibmFtZSIsImRpc3BsYXlCb2FyZCIsInN0YXRlIiwiaW5kZXgiLCJkZWJ1ZyIsImNvbnNvbGUiLCJsb2ciLCJkaXNwbGF5Iiwicm93IiwiY2VsbHMiLCJtYXAiLCJpdGVtIiwiZ2V0RW1weUNlbGxDb29yZHMiLCJjb29yZGluYXRlcyIsIm91dGVyIiwiaSIsImxlbmd0aCIsImoiLCJpc091dE9mQm9yZGVyIiwiY29vcmRzIiwiTm9kZSIsImNvbnN0cnVjdG9yIiwicGFyZW50Iiwib3BlcmF0b3IiLCJkZXB0aCIsImNvc3QiLCJ0aGlzIiwiZ2V0U3RhdGUiLCJnZXRNb3ZlcyIsImdldERlcHRoIiwicGF0aEZyb21TdGFydCIsInN0YXRlTGlzdCIsIm1vdmVMaXN0IiwiY3VycmVudE5vZGUiLCJwdXNoIiwicmV2ZXJzZSIsImpvaW4iLCJkYiIsIk1hcCIsInNldCIsInRvU3RyaW5nIiwicXVldWUiLCJhbGxTdGF0ZXMiLCJyZXN1bHRzIiwiY3VycmVudFN0YXRlIiwibW92ZXMiLCJzZXR0bGVkIiwiZHJvcHBlZCIsImhhdmVTb2x1dGlvbiIsImRyb3BwZWRTdGF0ZXMiLCJzaGlmdCIsInNpemUiLCJzZWNvbmRTdGF0ZSIsImVtcHR5Q2VsbCIsImZvckVhY2giLCJkaXJlY3Rpb24iLCJjb3B5U3RhdGUiLCJnZXQiLCJCRlMiLCJuZXh0U3RhdGVCdXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZXN1bHRCdXR0b24iLCJyZXN1bHRzV3JhcHBlciIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImluc2VydEFkamFjZW50SFRNTCIsInRhYmxlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJ0Ym9keSIsInRhYmxlUm93IiwiaW5zZXJ0Um93IiwiY29sIiwidGQiLCJpbnNlcnRDZWxsIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJIVE1MIiwiU3RyaW5nIiwiYXBwZW5kQ2hpbGQiXSwic291cmNlUm9vdCI6IiJ9