(()=>{"use strict";const e=[[6,null,2],[3,4,8],[7,1,5]],t=[{x:0,y:-1,name:"⇐"},{x:-1,y:0,name:"⇑"},{x:0,y:1,name:"⇒"},{x:1,y:0,name:"⇓"}],n=(e,t,n=!0)=>{console.log(`Index of the state ${t}`);let o="";for(let t of e){const e=t.map((e=>e||" "));o+="-------------\n",o+=`| ${e[0]} | ${e[1]} | ${e[2]} |\n`}return o+="-------------\n",n&&console.log(o),o},o=e=>{let t={x:0,y:0,name:"empty"};e:for(let n=0;n<e[0].length;++n)for(let o=0;o<e.length;++o)if(null===e[n][o]){t.x=n,t.y=o;break e}return t},s=e=>e.x>=3||e.x<0||e.y>=3||e.y<0;class l{constructor(e,t,o,s,l){this.getState=()=>this.state,this.getMoves=()=>this.operator,this.getDepth=()=>this.depth,this.pathFromStart=()=>{let e=[],t=[],o=this;do{e.push(o?.getState()),t.push(o?.getMoves()),o=o?.parent,o.parent||e.push(o?.getState())}while(0!==o?.getDepth());e.reverse(),t.reverse();let s=1;for(const t of e)n(t,s),s++;return console.log(`Кількість переміщень: ${t.length}`),console.log(`Переміщення по порядку: ${t.join(", ")}\n`),t},this.state=e,this.parent=t,this.operator=o,this.depth=s,this.cost=l}}let r={currentState:null,moves:0,settled:0,dropped:0,depth:0,haveSolution:!1};(()=>{let a=[{state:e,index:1}];const d=document.querySelector(".next"),c=document.querySelector(".result"),i=document.querySelector(".find"),p=document.getElementById("result-content");let h=0;const u=document.getElementById("results");d.disabled=!0,c.disabled=!0,d?.addEventListener("click",(()=>{const e=document.createElement("table");e.className+="table table-primary table-hover table-bordered table-sm align-middle caption-top",e.style.width="200px",e.style.height="200px",e.style.textAlign="center",e.insertAdjacentHTML("afterbegin",`\n               <caption class="fw-bold text-primary">\n                  Index of the state is ${a[h].index}\n               </caption>\n            `);const t=document.createElement("tbody");for(let e of a[h].state){const n=t.insertRow();for(let t of e){const e=n.insertCell();e.classList.add("align-middle"),e.innerHTML=t?String(t):" "}}e.appendChild(t),u?.appendChild(e),u.scrollTop=u.scrollHeight,n(a[h].state,a[h].index),h++})),c?.addEventListener("click",(()=>{p.innerHTML="",r.haveSolution?(console.log("Порядок переміщень для розв'язку гри в 8:"),r?.currentState?.pathFromStart(),console.log(`Кількість відвіданих станів: ${r.moves}`),console.log(`Кількість станів занесених у БД: ${r.settled}`),console.log(`Кількість відкинутих станів: ${r.dropped}`),console.log(`Глибина дерева пошуку на якій знайдено рішення: ${r.depth}`),p.insertAdjacentHTML("beforeend",`\n            <code>\n            <pre>Кількість відвіданих станів: ${r.moves}<br>Кількість станів занесених у БД: ${r.settled}<br>Кількість відкинутих станів: ${r.dropped}<br>Глибина дерева пошуку на якій знайдено рішення: ${r.depth}</pre>\n            </code>\n         `)):(console.log(`Кількість відвіданих станів: ${r.moves}`),console.log(`Кількість станів занесених у БД: ${r.settled}`),console.log(`Кількість відкинутих станів: ${r.dropped}`),console.log("Гра у 8 немає розв'язків"),p.insertAdjacentHTML("beforeend",`\n            <code>\n            <pre>Кількість відвіданих станів : ${r.moves}<br>Кількість станів занесених у БД : ${r.settled}<br>Кількість відкинутих станів : ${r.dropped}<br>Гра у 8 немає розв'язків</pre>\n            </code>\n         `))})),i?.addEventListener("click",(()=>{const e=e=>{const t=[];for(let n of e.rows){const e=[];for(let t of n.cells){const n=parseInt(t.innerHTML);Number.isNaN(n)?e.push(null):e.push(n)}t.push(e)}return t},n=document.querySelector(".initial-state"),i=document.querySelector(".final-state"),p=e(n),g=e(i);h=0,u.innerHTML=null,a=function(e,n,a){const d=new Map;d.set(e.toString(),!0);const c=[new l(e,null,null,0,0)];let i=0,p=0;for(;c.length;){let e=c.shift();if(r={currentState:e,moves:i,settled:d.size,dropped:p,depth:e.getDepth(),haveSolution:!1},h=n,e.getState()?.toString()===h?.toString())return r.haveSolution=!0,a;const u=o(e.getState());t.forEach((t=>{const n=e?.getState()?.map((e=>[...e])),o={x:u.x+t.x,y:u.y+t.y,name:t.name};s(o)||([n[u.x][u.y],n[o.x][o.y]]=[n[o.x][o.y],n[u.x][u.y]],d.get(n.toString())?p++:(c.push(new l(n,e,t.name,e.getDepth()+1,0)),d.set(n.toString(),!0),a.push({state:n,index:i+2})),i++)}))}var h;return a}(p,g,[{state:p,index:1}]),d.disabled=!1,c.disabled=!1}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dGFudHMudHMiLCJ3ZWJwYWNrOi8vbGFiMS8uL3NyYy9oZWxwZXJzLnRzIiwid2VicGFjazovL2xhYjEvLi9zcmMvbm9kZS50cyIsIndlYnBhY2s6Ly9sYWIxLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGV4cG9ydCBjb25zdCBpbml0aWFsU3RhdGUgPSBbXHJcbi8vICAgIFs1LCA2LCA3XSxcclxuLy8gICAgWzgsIDEsIDJdLFxyXG4vLyAgICBbMywgNCwgbnVsbF0sXHJcbi8vIF07XHJcbi8vIGV4cG9ydCBjb25zdCBpbml0aWFsU3RhdGUgPSBbXHJcbi8vICAgWzMsIDEsIDJdLFxyXG4vLyAgIFs0LCA1LCBudWxsXSxcclxuLy8gICBbNywgOCwgNl0sXHJcbi8vIF07XHJcbmV4cG9ydCBjb25zdCBpbml0aWFsU3RhdGUgPSBbXHJcbiAgICBbNiwgbnVsbCwgMl0sXHJcbiAgICBbMywgNCwgOF0sXHJcbiAgICBbNywgMSwgNV0sXHJcbl07XHJcbmV4cG9ydCBjb25zdCBmaW5hbFN0YXRlID0gW1xyXG4gICAgWzEsIDIsIDNdLFxyXG4gICAgWzQsIDUsIDZdLFxyXG4gICAgWzcsIDgsIG51bGxdLFxyXG5dO1xyXG5leHBvcnQgY29uc3QgZGlyZWN0aW9ucyA9IFtcclxuICAgIHsgeDogMCwgeTogLTEsIG5hbWU6IFwi4oeQXCIgfSxcclxuICAgIHsgeDogLTEsIHk6IDAsIG5hbWU6IFwi4oeRXCIgfSxcclxuICAgIHsgeDogMCwgeTogMSwgbmFtZTogXCLih5JcIiB9LFxyXG4gICAgeyB4OiAxLCB5OiAwLCBuYW1lOiBcIuKHk1wiIH0sXHJcbl07XHJcbmV4cG9ydCBjb25zdCBzaXplID0gMztcclxuZXhwb3J0IGNvbnN0IHByb2R1Y3Rpb24gPSB0cnVlO1xyXG4iLCJpbXBvcnQgeyBzaXplIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XHJcbmV4cG9ydCBmdW5jdGlvbiogZ2V0RXhlY3V0aW9uVGltZSgpIHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7XHJcbiAgICB5aWVsZCAxO1xyXG4gICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBjb25zdCBkaWZmID0gbmV3IERhdGUoZW5kVGltZSAtIHN0YXJ0VGltZSk7XHJcbiAgICBjb25zdCBleGVjdXRpb24gPSBkaWZmLmdldFNlY29uZHMoKSArIDAuMDAxICogZGlmZi5nZXRNaWxsaXNlY29uZHMoKTtcclxuICAgIGNvbnNvbGUubG9nKGBFeGVjdXRpb24gdGltZTogJHtleGVjdXRpb259IHNlY29uZHNgKTtcclxufVxyXG5leHBvcnQgY29uc3QgZGlzcGxheUJvYXJkID0gKHN0YXRlLCBpbmRleCwgZGVidWcgPSB0cnVlKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhgSW5kZXggb2YgdGhlIHN0YXRlICR7aW5kZXh9YCk7XHJcbiAgICBsZXQgZGlzcGxheSA9IFwiXCI7XHJcbiAgICBmb3IgKGxldCByb3cgb2Ygc3RhdGUpIHtcclxuICAgICAgICBjb25zdCBjZWxscyA9IHJvdy5tYXAoKGl0ZW0pID0+ICghaXRlbSA/IFwiIFwiIDogaXRlbSkpO1xyXG4gICAgICAgIGRpc3BsYXkgKz0gXCItLS0tLS0tLS0tLS0tXFxuXCI7XHJcbiAgICAgICAgZGlzcGxheSArPSBgfCAke2NlbGxzWzBdfSB8ICR7Y2VsbHNbMV19IHwgJHtjZWxsc1syXX0gfFxcbmA7XHJcbiAgICB9XHJcbiAgICBkaXNwbGF5ICs9IFwiLS0tLS0tLS0tLS0tLVxcblwiO1xyXG4gICAgaWYgKGRlYnVnKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGRpc3BsYXkpO1xyXG4gICAgcmV0dXJuIGRpc3BsYXk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBnZXRFbXB5Q2VsbENvb3JkcyA9IChzdGF0ZSkgPT4ge1xyXG4gICAgbGV0IGNvb3JkaW5hdGVzID0geyB4OiAwLCB5OiAwLCBuYW1lOiBcImVtcHR5XCIgfTtcclxuICAgIG91dGVyOiBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlWzBdLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzdGF0ZS5sZW5ndGg7ICsraikge1xyXG4gICAgICAgICAgICBpZiAoc3RhdGVbaV1bal0gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzLnggPSBpO1xyXG4gICAgICAgICAgICAgICAgY29vcmRpbmF0ZXMueSA9IGo7XHJcbiAgICAgICAgICAgICAgICBicmVhayBvdXRlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjb29yZGluYXRlcztcclxufTtcclxuZXhwb3J0IGNvbnN0IHN0YXRlc0FyZUVxdWFsID0gKHN0YXRlLCBzZWNvbmRTdGF0ZSkgPT4ge1xyXG4gICAgcmV0dXJuIHN0YXRlPy50b1N0cmluZygpID09PSBzZWNvbmRTdGF0ZT8udG9TdHJpbmcoKTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGlzT3V0T2ZCb3JkZXIgPSAoY29vcmRzKSA9PiB7XHJcbiAgICBpZiAoY29vcmRzLnggPj0gc2l6ZSB8fCBjb29yZHMueCA8IDApXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICBpZiAoY29vcmRzLnkgPj0gc2l6ZSB8fCBjb29yZHMueSA8IDApXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn07XHJcbiIsImltcG9ydCB7IGRpc3BsYXlCb2FyZCB9IGZyb20gXCIuL2hlbHBlcnNcIjtcclxuZXhwb3J0IGNsYXNzIE5vZGUge1xyXG4gICAgY29uc3RydWN0b3Ioc3RhdGUsIHBhcmVudCwgb3BlcmF0b3IsIGRlcHRoLCBjb3N0KSB7XHJcbiAgICAgICAgdGhpcy5nZXRTdGF0ZSA9ICgpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldE1vdmVzID0gKCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vcGVyYXRvcjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RGVwdGggPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlcHRoO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYXRoRnJvbVN0YXJ0ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgc3RhdGVMaXN0ID0gW107XHJcbiAgICAgICAgICAgIGxldCBtb3ZlTGlzdCA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzO1xyXG4gICAgICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZUxpc3QucHVzaChjdXJyZW50Tm9kZT8uZ2V0U3RhdGUoKSk7XHJcbiAgICAgICAgICAgICAgICBtb3ZlTGlzdC5wdXNoKGN1cnJlbnROb2RlPy5nZXRNb3ZlcygpKTtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGU/LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudE5vZGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVMaXN0LnB1c2goY3VycmVudE5vZGU/LmdldFN0YXRlKCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IHdoaWxlIChjdXJyZW50Tm9kZT8uZ2V0RGVwdGgoKSAhPT0gMCk7XHJcbiAgICAgICAgICAgIHN0YXRlTGlzdC5yZXZlcnNlKCk7XHJcbiAgICAgICAgICAgIG1vdmVMaXN0LnJldmVyc2UoKTtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gMTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHN0YXRlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgZGlzcGxheUJvYXJkKGl0ZW0sIGluZGV4KTtcclxuICAgICAgICAgICAgICAgIGluZGV4Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQv9C10YDQtdC80ZbRidC10L3RjDogJHttb3ZlTGlzdC5sZW5ndGh9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQn9C10YDQtdC80ZbRidC10L3QvdGPINC/0L4g0L/QvtGA0Y/QtNC60YM6ICR7bW92ZUxpc3Quam9pbihcIiwgXCIpfVxcbmApO1xyXG4gICAgICAgICAgICByZXR1cm4gbW92ZUxpc3Q7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XHJcbiAgICAgICAgdGhpcy5vcGVyYXRvciA9IG9wZXJhdG9yO1xyXG4gICAgICAgIHRoaXMuZGVwdGggPSBkZXB0aDtcclxuICAgICAgICB0aGlzLmNvc3QgPSBjb3N0O1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IGRpcmVjdGlvbnMsIGluaXRpYWxTdGF0ZSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xyXG5pbXBvcnQgeyBkaXNwbGF5Qm9hcmQsIGdldEVtcHlDZWxsQ29vcmRzLCBpc091dE9mQm9yZGVyLCBzdGF0ZXNBcmVFcXVhbCwgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XHJcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi9ub2RlXCI7XHJcbmxldCByZXN1bHRzID0ge1xyXG4gICAgY3VycmVudFN0YXRlOiBudWxsLFxyXG4gICAgbW92ZXM6IDAsXHJcbiAgICBzZXR0bGVkOiAwLFxyXG4gICAgZHJvcHBlZDogMCxcclxuICAgIGRlcHRoOiAwLFxyXG4gICAgaGF2ZVNvbHV0aW9uOiBmYWxzZSxcclxufTtcclxuY29uc3QgQkZTID0gZnVuY3Rpb24gKGluaXRpYWwsIGZpbmFsLCBzdGF0ZXMpIHtcclxuICAgIGNvbnN0IGRiID0gbmV3IE1hcCgpO1xyXG4gICAgZGIuc2V0KGluaXRpYWwudG9TdHJpbmcoKSwgdHJ1ZSk7XHJcbiAgICBjb25zdCBxdWV1ZSA9IFtuZXcgTm9kZShpbml0aWFsLCBudWxsLCBudWxsLCAwLCAwKV07XHJcbiAgICBsZXQgbW92ZXMgPSAwLCBkcm9wcGVkU3RhdGVzID0gMDtcclxuICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgICBsZXQgY3VycmVudFN0YXRlID0gcXVldWUuc2hpZnQoKTtcclxuICAgICAgICByZXN1bHRzID0ge1xyXG4gICAgICAgICAgICBjdXJyZW50U3RhdGU6IGN1cnJlbnRTdGF0ZSxcclxuICAgICAgICAgICAgbW92ZXM6IG1vdmVzLFxyXG4gICAgICAgICAgICBzZXR0bGVkOiBkYi5zaXplLFxyXG4gICAgICAgICAgICBkcm9wcGVkOiBkcm9wcGVkU3RhdGVzLFxyXG4gICAgICAgICAgICBkZXB0aDogY3VycmVudFN0YXRlLmdldERlcHRoKCksXHJcbiAgICAgICAgICAgIGhhdmVTb2x1dGlvbjogZmFsc2UsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoc3RhdGVzQXJlRXF1YWwoY3VycmVudFN0YXRlLmdldFN0YXRlKCksIGZpbmFsKSkge1xyXG4gICAgICAgICAgICByZXN1bHRzLmhhdmVTb2x1dGlvbiA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGVtcHR5Q2VsbCA9IGdldEVtcHlDZWxsQ29vcmRzKGN1cnJlbnRTdGF0ZS5nZXRTdGF0ZSgpKTtcclxuICAgICAgICBkaXJlY3Rpb25zLmZvckVhY2goKGRpcmVjdGlvbikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjb3B5U3RhdGUgPSBjdXJyZW50U3RhdGVcclxuICAgICAgICAgICAgICAgID8uZ2V0U3RhdGUoKVxyXG4gICAgICAgICAgICAgICAgPy5tYXAoKHJvdykgPT4gWy4uLnJvd10pO1xyXG4gICAgICAgICAgICAvLyBjb29yZHMgY2VsbCB0byBzd2l0Y2hcclxuICAgICAgICAgICAgY29uc3QgY29vcmRzID0ge1xyXG4gICAgICAgICAgICAgICAgeDogZW1wdHlDZWxsLnggKyBkaXJlY3Rpb24ueCxcclxuICAgICAgICAgICAgICAgIHk6IGVtcHR5Q2VsbC55ICsgZGlyZWN0aW9uLnksXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkaXJlY3Rpb24ubmFtZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgLy8gaWYgY29vcmRzIG9mIHN3YXBwZWQgY2VsbCBpcyBub3Qgb3V0IHRoZSBib3JkZXIgb2YgdGhlIGZpZWxkXHJcbiAgICAgICAgICAgIGlmICghaXNPdXRPZkJvcmRlcihjb29yZHMpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBtb3ZlIGVtcHR5IGNlbGwgaW50byBjdXJyZW50IGRpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgIGNvcHlTdGF0ZVtlbXB0eUNlbGwueF1bZW1wdHlDZWxsLnldLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvcHlTdGF0ZVtjb29yZHMueF1bY29vcmRzLnldLFxyXG4gICAgICAgICAgICAgICAgXSA9IFtcclxuICAgICAgICAgICAgICAgICAgICBjb3B5U3RhdGVbY29vcmRzLnhdW2Nvb3Jkcy55XSxcclxuICAgICAgICAgICAgICAgICAgICBjb3B5U3RhdGVbZW1wdHlDZWxsLnhdW2VtcHR5Q2VsbC55XSxcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICAvLyBpZiBzd2FwcGVkIHN0YXRlIGlzIG5vdCBwcmVzZW50IGluIGRhdGFiYXNlXHJcbiAgICAgICAgICAgICAgICBpZiAoIWRiLmdldChjb3B5U3RhdGUudG9TdHJpbmcoKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKG5ldyBOb2RlKGNvcHlTdGF0ZSwgY3VycmVudFN0YXRlLCBkaXJlY3Rpb24ubmFtZSwgY3VycmVudFN0YXRlLmdldERlcHRoKCkgKyAxLCAwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGIuc2V0KGNvcHlTdGF0ZS50b1N0cmluZygpLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZXMucHVzaCh7IHN0YXRlOiBjb3B5U3RhdGUsIGluZGV4OiBtb3ZlcyArIDIgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkcm9wcGVkU3RhdGVzKys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtb3ZlcysrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RhdGVzO1xyXG59O1xyXG4oKCkgPT4ge1xyXG4gICAgbGV0IGFsbFN0YXRlcyA9IFtcclxuICAgICAgICB7IHN0YXRlOiBpbml0aWFsU3RhdGUsIGluZGV4OiAxIH0sXHJcbiAgICBdO1xyXG4gICAgY29uc3QgbmV4dFN0YXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXh0XCIpO1xyXG4gICAgY29uc3QgcmVzdWx0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXN1bHRcIik7XHJcbiAgICBjb25zdCBmaW5kQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5maW5kXCIpO1xyXG4gICAgY29uc3QgcmVzdWx0Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0LWNvbnRlbnRcIik7XHJcbiAgICBsZXQgaW5kZXhPZk5leHRTdGF0ZSA9IDA7XHJcbiAgICBjb25zdCByZXN1bHRzV3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0c1wiKTtcclxuICAgIGNvbnN0IHVubG9ja0J1dHRvbnMgPSAoKSA9PiB7XHJcbiAgICAgICAgbmV4dFN0YXRlQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgcmVzdWx0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgZGlzYWJsZUJ1dHRvbnMgPSAoKSA9PiB7XHJcbiAgICAgICAgbmV4dFN0YXRlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICByZXN1bHRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IHByaW50UmVzdWx0cyA9ICgpID0+IHtcclxuICAgICAgICByZXN1bHRDb250ZW50LmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgaWYgKCFyZXN1bHRzLmhhdmVTb2x1dGlvbikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JrRltC70YzQutGW0YHRgtGMINCy0ZbQtNCy0ZbQtNCw0L3QuNGFINGB0YLQsNC90ZbQsjogJHtyZXN1bHRzLm1vdmVzfWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JrRltC70YzQutGW0YHRgtGMINGB0YLQsNC90ZbQsiDQt9Cw0L3QtdGB0LXQvdC40YUg0YMg0JHQlDogJHtyZXN1bHRzLnNldHRsZWR9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQmtGW0LvRjNC60ZbRgdGC0Ywg0LLRltC00LrQuNC90YPRgtC40YUg0YHRgtCw0L3RltCyOiAke3Jlc3VsdHMuZHJvcHBlZH1gKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLQk9GA0LAg0YMgOCDQvdC10LzQsNGUINGA0L7Qt9CyJ9GP0LfQutGW0LJcIik7XHJcbiAgICAgICAgICAgIHJlc3VsdENvbnRlbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGBcbiAgICAgICAgICAgIDxjb2RlPlxuICAgICAgICAgICAgPHByZT7QmtGW0LvRjNC60ZbRgdGC0Ywg0LLRltC00LLRltC00LDQvdC40YUg0YHRgtCw0L3RltCyIDogJHtyZXN1bHRzLm1vdmVzfTxicj7QmtGW0LvRjNC60ZbRgdGC0Ywg0YHRgtCw0L3RltCyINC30LDQvdC10YHQtdC90LjRhSDRgyDQkdCUIDogJHtyZXN1bHRzLnNldHRsZWR9PGJyPtCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQutC40L3Rg9GC0LjRhSDRgdGC0LDQvdGW0LIgOiAke3Jlc3VsdHMuZHJvcHBlZH08YnI+0JPRgNCwINGDIDgg0L3QtdC80LDRlCDRgNC+0LfQsifRj9C30LrRltCyPC9wcmU+XG4gICAgICAgICAgICA8L2NvZGU+XG4gICAgICAgICBgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi0J/QvtGA0Y/QtNC+0Log0L/QtdGA0LXQvNGW0YnQtdC90Ywg0LTQu9GPINGA0L7Qt9CyJ9GP0LfQutGDINCz0YDQuCDQsiA4OlwiKTtcclxuICAgICAgICAgICAgcmVzdWx0cz8uY3VycmVudFN0YXRlPy5wYXRoRnJvbVN0YXJ0KCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQmtGW0LvRjNC60ZbRgdGC0Ywg0LLRltC00LLRltC00LDQvdC40YUg0YHRgtCw0L3RltCyOiAke3Jlc3VsdHMubW92ZXN9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQmtGW0LvRjNC60ZbRgdGC0Ywg0YHRgtCw0L3RltCyINC30LDQvdC10YHQtdC90LjRhSDRgyDQkdCUOiAke3Jlc3VsdHMuc2V0dGxlZH1gKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQutC40L3Rg9GC0LjRhSDRgdGC0LDQvdGW0LI6ICR7cmVzdWx0cy5kcm9wcGVkfWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JPQu9C40LHQuNC90LAg0LTQtdGA0LXQstCwINC/0L7RiNGD0LrRgyDQvdCwINGP0LrRltC5INC30L3QsNC50LTQtdC90L4g0YDRltGI0LXQvdC90Y86ICR7cmVzdWx0cy5kZXB0aH1gKTtcclxuICAgICAgICAgICAgcmVzdWx0Q29udGVudC5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgYFxuICAgICAgICAgICAgPGNvZGU+XG4gICAgICAgICAgICA8cHJlPtCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQstGW0LTQsNC90LjRhSDRgdGC0LDQvdGW0LI6ICR7cmVzdWx0cy5tb3Zlc308YnI+0JrRltC70YzQutGW0YHRgtGMINGB0YLQsNC90ZbQsiDQt9Cw0L3QtdGB0LXQvdC40YUg0YMg0JHQlDogJHtyZXN1bHRzLnNldHRsZWR9PGJyPtCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQutC40L3Rg9GC0LjRhSDRgdGC0LDQvdGW0LI6ICR7cmVzdWx0cy5kcm9wcGVkfTxicj7Qk9C70LjQsdC40L3QsCDQtNC10YDQtdCy0LAg0L/QvtGI0YPQutGDINC90LAg0Y/QutGW0Lkg0LfQvdCw0LnQtNC10L3QviDRgNGW0YjQtdC90L3RjzogJHtyZXN1bHRzLmRlcHRofTwvcHJlPlxuICAgICAgICAgICAgPC9jb2RlPlxuICAgICAgICAgYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGRpc2FibGVCdXR0b25zKCk7XHJcbiAgICBuZXh0U3RhdGVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgLy8gQWRkIG5leHQgbmV3IHN0YXRlIHRhYmxlIHRvIHRoZSB2aWV3XHJcbiAgICAgICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGFibGVcIik7XHJcbiAgICAgICAgdGFibGUuY2xhc3NOYW1lICs9XHJcbiAgICAgICAgICAgIFwidGFibGUgdGFibGUtcHJpbWFyeSB0YWJsZS1ob3ZlciB0YWJsZS1ib3JkZXJlZCB0YWJsZS1zbSBhbGlnbi1taWRkbGUgY2FwdGlvbi10b3BcIjtcclxuICAgICAgICB0YWJsZS5zdHlsZS53aWR0aCA9IFwiMjAwcHhcIjtcclxuICAgICAgICB0YWJsZS5zdHlsZS5oZWlnaHQgPSBcIjIwMHB4XCI7XHJcbiAgICAgICAgdGFibGUuc3R5bGUudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcclxuICAgICAgICB0YWJsZS5pbnNlcnRBZGphY2VudEhUTUwoXCJhZnRlcmJlZ2luXCIsIGBcbiAgICAgICAgICAgICAgIDxjYXB0aW9uIGNsYXNzPVwiZnctYm9sZCB0ZXh0LXByaW1hcnlcIj5cbiAgICAgICAgICAgICAgICAgIEluZGV4IG9mIHRoZSBzdGF0ZSBpcyAke2FsbFN0YXRlc1tpbmRleE9mTmV4dFN0YXRlXS5pbmRleH1cbiAgICAgICAgICAgICAgIDwvY2FwdGlvbj5cbiAgICAgICAgICAgIGApO1xyXG4gICAgICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRib2R5XCIpO1xyXG4gICAgICAgIGZvciAobGV0IHJvdyBvZiBhbGxTdGF0ZXNbaW5kZXhPZk5leHRTdGF0ZV0uc3RhdGUpIHtcclxuICAgICAgICAgICAgY29uc3QgdGFibGVSb3cgPSB0Ym9keS5pbnNlcnRSb3coKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgY29sIG9mIHJvdykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGQgPSB0YWJsZVJvdy5pbnNlcnRDZWxsKCk7XHJcbiAgICAgICAgICAgICAgICB0ZC5jbGFzc0xpc3QuYWRkKFwiYWxpZ24tbWlkZGxlXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjb2wpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZC5pbm5lckhUTUwgPSBcIiBcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRkLmlubmVySFRNTCA9IFN0cmluZyhjb2wpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhYmxlLmFwcGVuZENoaWxkKHRib2R5KTtcclxuICAgICAgICByZXN1bHRzV3JhcHBlcj8uYXBwZW5kQ2hpbGQodGFibGUpO1xyXG4gICAgICAgIHJlc3VsdHNXcmFwcGVyLnNjcm9sbFRvcCA9IHJlc3VsdHNXcmFwcGVyLnNjcm9sbEhlaWdodDtcclxuICAgICAgICAvLyBwcmludCByZXN1bHRzIHRvIHRoZSBjb25zb2xlXHJcbiAgICAgICAgZGlzcGxheUJvYXJkKGFsbFN0YXRlc1tpbmRleE9mTmV4dFN0YXRlXS5zdGF0ZSwgYWxsU3RhdGVzW2luZGV4T2ZOZXh0U3RhdGVdLmluZGV4KTtcclxuICAgICAgICBpbmRleE9mTmV4dFN0YXRlKys7XHJcbiAgICB9KTtcclxuICAgIHJlc3VsdEJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBwcmludFJlc3VsdHMoKTtcclxuICAgIH0pO1xyXG4gICAgZmluZEJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBjb25zdCBnZXRUYWJsZVN0YXRlID0gKHRhYmxlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IHJvdyBvZiB0YWJsZS5yb3dzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZVJvdyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgY2VsbCBvZiByb3cuY2VsbHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsRGF0YSA9IHBhcnNlSW50KGNlbGwuaW5uZXJIVE1MKTtcclxuICAgICAgICAgICAgICAgICAgICBOdW1iZXIuaXNOYU4oY2VsbERhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc3RhdGVSb3cucHVzaChudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHN0YXRlUm93LnB1c2goY2VsbERhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RhdGUucHVzaChzdGF0ZVJvdyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbFN0YXRlVGFibGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmluaXRpYWwtc3RhdGVcIik7XHJcbiAgICAgICAgY29uc3QgZmluYWxTdGF0ZVRhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5maW5hbC1zdGF0ZVwiKTtcclxuICAgICAgICBjb25zdCBpbml0aWFsID0gZ2V0VGFibGVTdGF0ZShpbml0aWFsU3RhdGVUYWJsZSk7XHJcbiAgICAgICAgY29uc3QgZmluYWwgPSBnZXRUYWJsZVN0YXRlKGZpbmFsU3RhdGVUYWJsZSk7XHJcbiAgICAgICAgLy8gcmVzZXQgc3RlcCBieSBzdGVwIHJlc3VsdHMgb3V0cHV0XHJcbiAgICAgICAgaW5kZXhPZk5leHRTdGF0ZSA9IDA7XHJcbiAgICAgICAgcmVzdWx0c1dyYXBwZXIuaW5uZXJIVE1MID0gbnVsbDtcclxuICAgICAgICBhbGxTdGF0ZXMgPSBCRlMoaW5pdGlhbCwgZmluYWwsIFt7IHN0YXRlOiBpbml0aWFsLCBpbmRleDogMSB9XSk7XHJcbiAgICAgICAgdW5sb2NrQnV0dG9ucygpO1xyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiJdLCJuYW1lcyI6WyJpbml0aWFsU3RhdGUiLCJkaXJlY3Rpb25zIiwieCIsInkiLCJuYW1lIiwiZGlzcGxheUJvYXJkIiwic3RhdGUiLCJpbmRleCIsImRlYnVnIiwiY29uc29sZSIsImxvZyIsImRpc3BsYXkiLCJyb3ciLCJjZWxscyIsIm1hcCIsIml0ZW0iLCJnZXRFbXB5Q2VsbENvb3JkcyIsImNvb3JkaW5hdGVzIiwib3V0ZXIiLCJpIiwibGVuZ3RoIiwiaiIsImlzT3V0T2ZCb3JkZXIiLCJjb29yZHMiLCJOb2RlIiwiY29uc3RydWN0b3IiLCJwYXJlbnQiLCJvcGVyYXRvciIsImRlcHRoIiwiY29zdCIsInRoaXMiLCJnZXRTdGF0ZSIsImdldE1vdmVzIiwiZ2V0RGVwdGgiLCJwYXRoRnJvbVN0YXJ0Iiwic3RhdGVMaXN0IiwibW92ZUxpc3QiLCJjdXJyZW50Tm9kZSIsInB1c2giLCJyZXZlcnNlIiwiam9pbiIsInJlc3VsdHMiLCJjdXJyZW50U3RhdGUiLCJtb3ZlcyIsInNldHRsZWQiLCJkcm9wcGVkIiwiaGF2ZVNvbHV0aW9uIiwiYWxsU3RhdGVzIiwibmV4dFN0YXRlQnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicmVzdWx0QnV0dG9uIiwiZmluZEJ1dHRvbiIsInJlc3VsdENvbnRlbnQiLCJnZXRFbGVtZW50QnlJZCIsImluZGV4T2ZOZXh0U3RhdGUiLCJyZXN1bHRzV3JhcHBlciIsImRpc2FibGVkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRhYmxlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJ0ZXh0QWxpZ24iLCJpbnNlcnRBZGphY2VudEhUTUwiLCJ0Ym9keSIsInRhYmxlUm93IiwiaW5zZXJ0Um93IiwiY29sIiwidGQiLCJpbnNlcnRDZWxsIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJIVE1MIiwiU3RyaW5nIiwiYXBwZW5kQ2hpbGQiLCJzY3JvbGxUb3AiLCJzY3JvbGxIZWlnaHQiLCJnZXRUYWJsZVN0YXRlIiwicm93cyIsInN0YXRlUm93IiwiY2VsbCIsImNlbGxEYXRhIiwicGFyc2VJbnQiLCJOdW1iZXIiLCJpc05hTiIsImluaXRpYWxTdGF0ZVRhYmxlIiwiZmluYWxTdGF0ZVRhYmxlIiwiaW5pdGlhbCIsImZpbmFsIiwic3RhdGVzIiwiZGIiLCJNYXAiLCJzZXQiLCJ0b1N0cmluZyIsInF1ZXVlIiwiZHJvcHBlZFN0YXRlcyIsInNoaWZ0Iiwic2l6ZSIsInNlY29uZFN0YXRlIiwiZW1wdHlDZWxsIiwiZm9yRWFjaCIsImRpcmVjdGlvbiIsImNvcHlTdGF0ZSIsImdldCIsIkJGUyJdLCJzb3VyY2VSb290IjoiIn0=